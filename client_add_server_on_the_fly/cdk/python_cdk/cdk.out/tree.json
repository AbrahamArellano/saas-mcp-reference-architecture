{"version":"tree-0.1","tree":{"id":"App","path":"","children":{"BedrockMcpStack-cdk122320":{"id":"BedrockMcpStack-cdk122320","path":"BedrockMcpStack-cdk122320","children":{"MCP-VPC":{"id":"MCP-VPC","path":"BedrockMcpStack-cdk122320/MCP-VPC","children":{"Resource":{"id":"Resource","path":"BedrockMcpStack-cdk122320/MCP-VPC/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPC","aws:cdk:cloudformation:props":{"cidrBlock":"10.0.0.0/16","enableDnsHostnames":true,"enableDnsSupport":true,"instanceTenancy":"default","tags":[{"key":"Name","value":"BedrockMcpStack-cdk122320/MCP-VPC"}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPC","version":"2.197.0"}},"PublicSubnet1":{"id":"PublicSubnet1","path":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet1","children":{"Subnet":{"id":"Subnet","path":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet1/Subnet","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-west-2a","cidrBlock":"10.0.0.0/24","mapPublicIpOnLaunch":true,"tags":[{"key":"aws-cdk:subnet-name","value":"Public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet1"}],"vpcId":{"Ref":"MCPVPC68ADF9D1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.197.0"}},"Acl":{"id":"Acl","path":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet1/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.197.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet1/RouteTable","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet1"}],"vpcId":{"Ref":"MCPVPC68ADF9D1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.197.0"}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet1/RouteTableAssociation","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"MCPVPCPublicSubnet1RouteTable9B162551"},"subnetId":{"Ref":"MCPVPCPublicSubnet1Subnet426F3236"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.197.0"}},"DefaultRoute":{"id":"DefaultRoute","path":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet1/DefaultRoute","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"MCPVPCIGWEE21D79C"},"routeTableId":{"Ref":"MCPVPCPublicSubnet1RouteTable9B162551"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.197.0"}},"EIP":{"id":"EIP","path":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet1/EIP","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::EIP","aws:cdk:cloudformation:props":{"domain":"vpc","tags":[{"key":"Name","value":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet1"}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnEIP","version":"2.197.0"}},"NATGateway":{"id":"NATGateway","path":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet1/NATGateway","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::NatGateway","aws:cdk:cloudformation:props":{"allocationId":{"Fn::GetAtt":["MCPVPCPublicSubnet1EIPDB7D7A07","AllocationId"]},"subnetId":{"Ref":"MCPVPCPublicSubnet1Subnet426F3236"},"tags":[{"key":"Name","value":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet1"}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnNatGateway","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.197.0","metadata":[]}},"PublicSubnet2":{"id":"PublicSubnet2","path":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet2","children":{"Subnet":{"id":"Subnet","path":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet2/Subnet","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-west-2b","cidrBlock":"10.0.1.0/24","mapPublicIpOnLaunch":true,"tags":[{"key":"aws-cdk:subnet-name","value":"Public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet2"}],"vpcId":{"Ref":"MCPVPC68ADF9D1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.197.0"}},"Acl":{"id":"Acl","path":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet2/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.197.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet2/RouteTable","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet2"}],"vpcId":{"Ref":"MCPVPC68ADF9D1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.197.0"}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet2/RouteTableAssociation","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"MCPVPCPublicSubnet2RouteTableDF4F90E1"},"subnetId":{"Ref":"MCPVPCPublicSubnet2Subnet2C6BF23A"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.197.0"}},"DefaultRoute":{"id":"DefaultRoute","path":"BedrockMcpStack-cdk122320/MCP-VPC/PublicSubnet2/DefaultRoute","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"MCPVPCIGWEE21D79C"},"routeTableId":{"Ref":"MCPVPCPublicSubnet2RouteTableDF4F90E1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.197.0","metadata":[]}},"PrivateSubnet1":{"id":"PrivateSubnet1","path":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet1","children":{"Subnet":{"id":"Subnet","path":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet1/Subnet","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-west-2a","cidrBlock":"10.0.2.0/24","mapPublicIpOnLaunch":false,"tags":[{"key":"aws-cdk:subnet-name","value":"Private"},{"key":"aws-cdk:subnet-type","value":"Private"},{"key":"Name","value":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet1"}],"vpcId":{"Ref":"MCPVPC68ADF9D1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.197.0"}},"Acl":{"id":"Acl","path":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet1/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.197.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet1/RouteTable","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet1"}],"vpcId":{"Ref":"MCPVPC68ADF9D1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.197.0"}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet1/RouteTableAssociation","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"MCPVPCPrivateSubnet1RouteTable30C7F3CF"},"subnetId":{"Ref":"MCPVPCPrivateSubnet1Subnet2890C8B8"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.197.0"}},"DefaultRoute":{"id":"DefaultRoute","path":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet1/DefaultRoute","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","natGatewayId":{"Ref":"MCPVPCPublicSubnet1NATGateway718A439E"},"routeTableId":{"Ref":"MCPVPCPrivateSubnet1RouteTable30C7F3CF"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PrivateSubnet","version":"2.197.0","metadata":[]}},"PrivateSubnet2":{"id":"PrivateSubnet2","path":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet2","children":{"Subnet":{"id":"Subnet","path":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet2/Subnet","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-west-2b","cidrBlock":"10.0.3.0/24","mapPublicIpOnLaunch":false,"tags":[{"key":"aws-cdk:subnet-name","value":"Private"},{"key":"aws-cdk:subnet-type","value":"Private"},{"key":"Name","value":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet2"}],"vpcId":{"Ref":"MCPVPC68ADF9D1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.197.0"}},"Acl":{"id":"Acl","path":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet2/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.197.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet2/RouteTable","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet2"}],"vpcId":{"Ref":"MCPVPC68ADF9D1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.197.0"}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet2/RouteTableAssociation","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"MCPVPCPrivateSubnet2RouteTableB7666F52"},"subnetId":{"Ref":"MCPVPCPrivateSubnet2Subnet938C6756"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.197.0"}},"DefaultRoute":{"id":"DefaultRoute","path":"BedrockMcpStack-cdk122320/MCP-VPC/PrivateSubnet2/DefaultRoute","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","natGatewayId":{"Ref":"MCPVPCPublicSubnet1NATGateway718A439E"},"routeTableId":{"Ref":"MCPVPCPrivateSubnet2RouteTableB7666F52"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PrivateSubnet","version":"2.197.0","metadata":[]}},"IGW":{"id":"IGW","path":"BedrockMcpStack-cdk122320/MCP-VPC/IGW","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::InternetGateway","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"BedrockMcpStack-cdk122320/MCP-VPC"}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnInternetGateway","version":"2.197.0"}},"VPCGW":{"id":"VPCGW","path":"BedrockMcpStack-cdk122320/MCP-VPC/VPCGW","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCGatewayAttachment","aws:cdk:cloudformation:props":{"internetGatewayId":{"Ref":"MCPVPCIGWEE21D79C"},"vpcId":{"Ref":"MCPVPC68ADF9D1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCGatewayAttachment","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Vpc","version":"2.197.0","metadata":[]}},"MCP-SG":{"id":"MCP-SG","path":"BedrockMcpStack-cdk122320/MCP-SG","children":{"Resource":{"id":"Resource","path":"BedrockMcpStack-cdk122320/MCP-SG/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Security group for MCP services","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"securityGroupIngress":[{"cidrIp":"0.0.0.0/0","ipProtocol":"tcp","fromPort":8502,"toPort":8502,"description":"Streamlit UI"}],"vpcId":{"Ref":"MCPVPC68ADF9D1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.197.0"}},"from BedrockMcpStackcdk122320MCPALBSecurityGroupDA4714AA:8502":{"id":"from BedrockMcpStackcdk122320MCPALBSecurityGroupDA4714AA:8502","path":"BedrockMcpStack-cdk122320/MCP-SG/from BedrockMcpStackcdk122320MCPALBSecurityGroupDA4714AA:8502","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupIngress","aws:cdk:cloudformation:props":{"description":"Load balancer to target","fromPort":8502,"groupId":{"Fn::GetAtt":["MCPSGCDEB721B","GroupId"]},"ipProtocol":"tcp","sourceSecurityGroupId":{"Fn::GetAtt":["MCPALBSecurityGroup05683423","GroupId"]},"toPort":8502}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.197.0","metadata":[]}},"EC2-Role":{"id":"EC2-Role","path":"BedrockMcpStack-cdk122320/EC2-Role","children":{"ImportEC2-Role":{"id":"ImportEC2-Role","path":"BedrockMcpStack-cdk122320/EC2-Role/ImportEC2-Role","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.197.0","metadata":[]}},"Resource":{"id":"Resource","path":"BedrockMcpStack-cdk122320/EC2-Role/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ec2.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AmazonSSMManagedInstanceCore"]]}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.197.0"}},"DefaultPolicy":{"id":"DefaultPolicy","path":"BedrockMcpStack-cdk122320/EC2-Role/DefaultPolicy","children":{"Resource":{"id":"Resource","path":"BedrockMcpStack-cdk122320/EC2-Role/DefaultPolicy/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["bedrock:InvokeModel*","bedrock:ListFoundationModels"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"EC2RoleDefaultPolicy98645454","roles":[{"Ref":"EC2Role24AC9335"}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.197.0","metadata":[]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.197.0","metadata":[]}},"MCP-ALB":{"id":"MCP-ALB","path":"BedrockMcpStack-cdk122320/MCP-ALB","children":{"Resource":{"id":"Resource","path":"BedrockMcpStack-cdk122320/MCP-ALB/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::LoadBalancer","aws:cdk:cloudformation:props":{"loadBalancerAttributes":[{"key":"deletion_protection.enabled","value":"false"}],"scheme":"internet-facing","securityGroups":[{"Fn::GetAtt":["MCPALBSecurityGroup05683423","GroupId"]}],"subnets":[{"Ref":"MCPVPCPublicSubnet1Subnet426F3236"},{"Ref":"MCPVPCPublicSubnet2Subnet2C6BF23A"}],"type":"application"}},"constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnLoadBalancer","version":"2.197.0"}},"SecurityGroup":{"id":"SecurityGroup","path":"BedrockMcpStack-cdk122320/MCP-ALB/SecurityGroup","children":{"Resource":{"id":"Resource","path":"BedrockMcpStack-cdk122320/MCP-ALB/SecurityGroup/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Automatically created Security Group for ELB BedrockMcpStackcdk122320MCPALBB0AA225B","securityGroupIngress":[{"cidrIp":"0.0.0.0/0","ipProtocol":"tcp","fromPort":8502,"toPort":8502,"description":"Allow from anyone on port 8502"}],"vpcId":{"Ref":"MCPVPC68ADF9D1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.197.0"}},"to BedrockMcpStackcdk122320MCPSG4B59DAA1:8502":{"id":"to BedrockMcpStackcdk122320MCPSG4B59DAA1:8502","path":"BedrockMcpStack-cdk122320/MCP-ALB/SecurityGroup/to BedrockMcpStackcdk122320MCPSG4B59DAA1:8502","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupEgress","aws:cdk:cloudformation:props":{"description":"Load balancer to target","destinationSecurityGroupId":{"Fn::GetAtt":["MCPSGCDEB721B","GroupId"]},"fromPort":8502,"groupId":{"Fn::GetAtt":["MCPALBSecurityGroup05683423","GroupId"]},"ipProtocol":"tcp","toPort":8502}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupEgress","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.197.0","metadata":[]}},"Streamlit":{"id":"Streamlit","path":"BedrockMcpStack-cdk122320/MCP-ALB/Streamlit","children":{"Resource":{"id":"Resource","path":"BedrockMcpStack-cdk122320/MCP-ALB/Streamlit/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::Listener","aws:cdk:cloudformation:props":{"defaultActions":[{"type":"forward","targetGroupArn":{"Ref":"MCPALBStreamlitStreamlitTargetGroup14A4FF23"}}],"loadBalancerArn":{"Ref":"MCPALBD851607E"},"port":8502,"protocol":"HTTP"}},"constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnListener","version":"2.197.0"}},"Streamlit-TargetGroup":{"id":"Streamlit-TargetGroup","path":"BedrockMcpStack-cdk122320/MCP-ALB/Streamlit/Streamlit-TargetGroup","children":{"Resource":{"id":"Resource","path":"BedrockMcpStack-cdk122320/MCP-ALB/Streamlit/Streamlit-TargetGroup/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::TargetGroup","aws:cdk:cloudformation:props":{"healthCheckIntervalSeconds":30,"healthCheckPath":"/","healthyThresholdCount":5,"port":8502,"protocol":"HTTP","targetGroupAttributes":[{"key":"stickiness.enabled","value":"false"}],"targetType":"instance","unhealthyThresholdCount":2,"vpcId":{"Ref":"MCPVPC68ADF9D1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnTargetGroup","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationTargetGroup","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationListener","version":"2.197.0","metadata":[]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationLoadBalancer","version":"2.197.0","metadata":[]}},"BedrockApiUser":{"id":"BedrockApiUser","path":"BedrockMcpStack-cdk122320/BedrockApiUser","children":{"Resource":{"id":"Resource","path":"BedrockMcpStack-cdk122320/BedrockApiUser/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::User","aws:cdk:cloudformation:props":{"userName":"bedrock-mcp-api-user-BedrockMcpStack-cdk122320"}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnUser","version":"2.197.0"}},"DefaultPolicy":{"id":"DefaultPolicy","path":"BedrockMcpStack-cdk122320/BedrockApiUser/DefaultPolicy","children":{"Resource":{"id":"Resource","path":"BedrockMcpStack-cdk122320/BedrockApiUser/DefaultPolicy/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["bedrock:InvokeModel*","bedrock:ListFoundationModels"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"BedrockApiUserDefaultPolicyF146F7E1","users":[{"Ref":"BedrockApiUserAE370C47"}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.197.0","metadata":[]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.User","version":"2.197.0","metadata":[]}},"BedrockApiAccessKey":{"id":"BedrockApiAccessKey","path":"BedrockMcpStack-cdk122320/BedrockApiAccessKey","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::AccessKey","aws:cdk:cloudformation:props":{"userName":{"Ref":"BedrockApiUserAE370C47"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnAccessKey","version":"2.197.0"}},"MCP-ASG":{"id":"MCP-ASG","path":"BedrockMcpStack-cdk122320/MCP-ASG","children":{"InstanceProfile":{"id":"InstanceProfile","path":"BedrockMcpStack-cdk122320/MCP-ASG/InstanceProfile","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::InstanceProfile","aws:cdk:cloudformation:props":{"roles":[{"Ref":"EC2Role24AC9335"}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnInstanceProfile","version":"2.197.0"}},"LaunchConfig":{"id":"LaunchConfig","path":"BedrockMcpStack-cdk122320/MCP-ASG/LaunchConfig","attributes":{"aws:cdk:cloudformation:type":"AWS::AutoScaling::LaunchConfiguration","aws:cdk:cloudformation:props":{"blockDeviceMappings":[{"deviceName":"/dev/sda1","ebs":{"volumeSize":100}}],"iamInstanceProfile":{"Ref":"MCPASGInstanceProfile49290BBB"},"imageId":{"Ref":"SsmParameterValueawsservicecanonicalubuntuserver2204stablecurrentamd64hvmebsgp2amiidC96584B6F00A464EAD1953AFF4B05118Parameter"},"instanceType":"t3.medium","securityGroups":[{"Fn::GetAtt":["MCPSGCDEB721B","GroupId"]}],"userData":{"Fn::Base64":{"Fn::Join":["",["#!/bin/bash\n#!/bin/bash\nexport HOME=/root\nexport PATH=\"/usr/local/bin:$PATH\"\napt-get update\napt-get install -y software-properties-common\nadd-apt-repository -y ppa:deadsnakes/ppa\napt-get update\napt-get install -y python3.12 python3.12-venv git\ncurl -fsSL https://deb.nodesource.com/setup_22.x | bash -\napt-get install -y nodejs\nsu - ubuntu -c \"curl -LsSf https://astral.sh/uv/install.sh | sh\"\necho 'export PATH=\"/home/ubuntu/.local/bin:$PATH\"' >> /home/ubuntu/.bashrc\nmkdir -p /home/ubuntu/demo_mcp_on_amazon_bedrock\nchown ubuntu:ubuntu /home/ubuntu/demo_mcp_on_amazon_bedrock\ncd /home/ubuntu/demo_mcp_on_amazon_bedrock\nMAX_RETRIES=3\nRETRY_COUNT=0\nwhile [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n    git clone https://github.com/aws-samples/demo_mcp_on_amazon_bedrock.git . && break\n    RETRY_COUNT=$((RETRY_COUNT+1))\n    if [ $RETRY_COUNT -lt $MAX_RETRIES ]; then\n        echo \"Git clone attempt $RETRY_COUNT failed, retrying in 5 seconds...\"\n        sleep 5\n    fi\ndone\n[ -z \"$(ls -A /home/ubuntu/demo_mcp_on_amazon_bedrock)\" ] && echo \"Failed to clone repository\" && exit 1\nmkdir -p logs tmp\nchown -R ubuntu:ubuntu /home/ubuntu/demo_mcp_on_amazon_bedrock\nchmod 755 /home/ubuntu/demo_mcp_on_amazon_bedrock\nchmod 755 logs tmp\nsu - ubuntu -c \"cd /home/ubuntu/demo_mcp_on_amazon_bedrock &&                 python3.12 -m venv .venv &&                 source .venv/bin/activate &&                 source /home/ubuntu/.bashrc &&                 uv pip install .\"\ncat > .env << EOL\nAWS_ACCESS_KEY_ID=",{"Ref":"BedrockApiAccessKey"},"\nAWS_SECRET_ACCESS_KEY=",{"Fn::GetAtt":["BedrockApiAccessKey","SecretAccessKey"]},"\nAWS_REGION=us-west-2\nLOG_DIR=./logs\nCHATBOT_SERVICE_PORT=8502\nMCP_SERVICE_HOST=127.0.0.1\nMCP_SERVICE_PORT=7002\nAPI_KEY=BedrockMcpStackcdk122320\nEOL\nchown ubuntu:ubuntu .env\nchmod 600 .env\ncat > /etc/systemd/system/mcp-services.service << EOL\n[Unit]\nDescription=MCP Services\nAfter=network.target\n\n[Service]\nType=forking\nUser=ubuntu\nEnvironment=\"HOME=/home/ubuntu\"\nEnvironment=\"PATH=/home/ubuntu/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\nWorkingDirectory=/home/ubuntu/demo_mcp_on_amazon_bedrock\nExecStart=/bin/bash start_all.sh\nExecStop=/bin/bash stop_all.sh\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\nEOL\nsystemctl daemon-reload\nsystemctl enable mcp-services\nsystemctl start mcp-services"]]}}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_autoscaling.CfnLaunchConfiguration","version":"2.197.0"}},"ASG":{"id":"ASG","path":"BedrockMcpStack-cdk122320/MCP-ASG/ASG","attributes":{"aws:cdk:cloudformation:type":"AWS::AutoScaling::AutoScalingGroup","aws:cdk:cloudformation:props":{"launchConfigurationName":{"Ref":"MCPASGLaunchConfig95C5231D"},"maxSize":"1","minSize":"1","tags":[{"key":"Name","value":"BedrockMcpStack-cdk122320/MCP-ASG","propagateAtLaunch":true}],"targetGroupArns":[{"Ref":"MCPALBStreamlitStreamlitTargetGroup14A4FF23"}],"vpcZoneIdentifier":[{"Ref":"MCPVPCPrivateSubnet1Subnet2890C8B8"},{"Ref":"MCPVPCPrivateSubnet2Subnet938C6756"}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_autoscaling.CfnAutoScalingGroup","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_autoscaling.AutoScalingGroup","version":"2.197.0","metadata":[]}},"SsmParameterValue:--aws--service--canonical--ubuntu--server--22.04--stable--current--amd64--hvm--ebs-gp2--ami-id:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter":{"id":"SsmParameterValue:--aws--service--canonical--ubuntu--server--22.04--stable--current--amd64--hvm--ebs-gp2--ami-id:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","path":"BedrockMcpStack-cdk122320/SsmParameterValue:--aws--service--canonical--ubuntu--server--22.04--stable--current--amd64--hvm--ebs-gp2--ami-id:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.197.0"}},"SsmParameterValue:--aws--service--canonical--ubuntu--server--22.04--stable--current--amd64--hvm--ebs-gp2--ami-id:C96584B6-F00A-464E-AD19-53AFF4B05118":{"id":"SsmParameterValue:--aws--service--canonical--ubuntu--server--22.04--stable--current--amd64--hvm--ebs-gp2--ami-id:C96584B6-F00A-464E-AD19-53AFF4B05118","path":"BedrockMcpStack-cdk122320/SsmParameterValue:--aws--service--canonical--ubuntu--server--22.04--stable--current--amd64--hvm--ebs-gp2--ami-id:C96584B6-F00A-464E-AD19-53AFF4B05118","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.197.0","metadata":[]}},"Streamlit-Endpoint":{"id":"Streamlit-Endpoint","path":"BedrockMcpStack-cdk122320/Streamlit-Endpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"ApiAccessKeyId":{"id":"ApiAccessKeyId","path":"BedrockMcpStack-cdk122320/ApiAccessKeyId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"ApiSecretAccessKey":{"id":"ApiSecretAccessKey","path":"BedrockMcpStack-cdk122320/ApiSecretAccessKey","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.197.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"BedrockMcpStack-cdk122320/CDKMetadata","children":{"Default":{"id":"Default","path":"BedrockMcpStack-cdk122320/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.197.0"}}},"constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"BootstrapVersion":{"id":"BootstrapVersion","path":"BedrockMcpStack-cdk122320/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.197.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"BedrockMcpStack-cdk122320/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.197.0"}}},"constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.197.0"}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}},"constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.197.0"}}}